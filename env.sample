# ==============================================================================
# Flashcard Orchestrator - Environment Variables
# ==============================================================================
#
# Copy this file to .env and fill in the values.
# 
# Usage:
#   cp env.sample .env
#   # Edit .env with your values
#   docker compose -f docker-compose.prod.yml up -d
#

# ==============================================================================
# General
# ==============================================================================

NODE_ENV=production
LOG_LEVEL=info
API_PORT=5000

# ==============================================================================
# LLM Configuration (at least one required for real mode)
# ==============================================================================

# Google Gemini API
GEMINI_API_KEY=

# OpenAI API
OPENAI_API_KEY=

# LLM Settings
LLM_PROVIDER=gemini
LLM_MODEL=gemini-1.5-flash
LLM_TIMEOUT_MS=60000
LLM_MAX_RETRIES=3

# ==============================================================================
# Embeddings
# ==============================================================================

EMBEDDING_PROVIDER=gemini
# Options: gemini, openai, local
EMBEDDING_MODEL=text-embedding-004
EMBEDDING_DIMENSION=768
EMBEDDING_BATCH_SIZE=64

# Local embeddings (if using local provider)
EMBEDDINGS_LOCAL_URL=http://localhost:8080

# ==============================================================================
# Vector Database
# ==============================================================================

VECTOR_DB_PROVIDER=qdrant
# Options: qdrant, pinecone

# Qdrant
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=
QDRANT_COLLECTION=flashcard_chunks

# Pinecone
PINECONE_API_KEY=
PINECONE_INDEX=flashcard-chunks
PINECONE_ENVIRONMENT=gcp-starter

# Vector settings
VECTOR_UPSERT_BATCH_SIZE=100
VECTOR_QUERY_TOP_K=10

# ==============================================================================
# Database
# ==============================================================================

# PostgreSQL (production)
DATABASE_URL=postgres://postgres:postgres@localhost:5432/flashcards
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=flashcards
POSTGRES_PORT=5432

# SQLite (development/testing)
USE_SQLITE=false
SQLITE_PATH=./server/tmp/flashcards.db

# Use DB store instead of file store
USE_DB_STORE=true

# ==============================================================================
# Redis (Job Queue)
# ==============================================================================

REDIS_URL=redis://localhost:6379
REDIS_PORT=6379

# ==============================================================================
# Transcription
# ==============================================================================

TRANSCRIPTION_PROVIDER=whisperx
# Options: whisperx, google_stt

# WhisperX settings
WHISPERX_MODEL=base
# Options: tiny, base, small, medium, large-v2
WHISPERX_DEVICE=cpu
# Options: cpu, cuda
WHISPERX_COMPUTE_TYPE=int8
# Options: int8, float16, float32

# Google Speech-to-Text
GOOGLE_APPLICATION_CREDENTIALS=
GOOGLE_PROJECT_ID=
GCS_BUCKET=

# ==============================================================================
# Media / Signed Links
# ==============================================================================

# JWT Signing Key (REQUIRED - generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
SIGNING_KEY=dev-signing-key-change-me-in-production

# Link expiry in seconds
MEDIA_LINK_EXPIRY_SECONDS=300

# Local media storage path
LOCAL_MEDIA_PATH=./server/tmp/media

# Google Drive
GOOGLE_SERVICE_ACCOUNT_JSON=

# Microsoft OneDrive / Graph
MS_GRAPH_CLIENT_ID=
MS_GRAPH_CLIENT_SECRET=
MS_GRAPH_TENANT_ID=

# ==============================================================================
# Rate Limiting
# ==============================================================================

RATE_LIMIT_GENERATE_PER_MIN=5
RATE_LIMIT_STATUS_PER_MIN=60
RATE_LIMIT_MEDIA_PER_MIN=60

# ==============================================================================
# Worker Configuration
# ==============================================================================

WORKER_CONCURRENCY=2
TRANSCRIPTION_CONCURRENCY=1

# ==============================================================================
# Cost Controls
# ==============================================================================

COST_BUDGET_DAILY=100
COST_PER_EMBEDDING=0.0001
COST_CONTROL_MODE=normal
# Options: normal, draft_only, queue_only, disabled

# ==============================================================================
# Monitoring
# ==============================================================================

PROMETHEUS_PORT=9090
GRAFANA_PORT=3001
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin

# ==============================================================================
# Feature Flags
# ==============================================================================

ENABLE_AUTO_GENERATION=true
ENABLE_VERIFICATION=true
ENABLE_TRANSCRIPTION=true
DRAFT_MODE=false

# ==============================================================================
# Development / Testing
# ==============================================================================

# Force mock mode even with keys present
FORCE_MOCK_LLM=false
FORCE_MOCK_EMBEDDINGS=false

# Verbose logging
VERBOSE=false
